<!DOCTYPE html>
<html lang="en" theme="prefers">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Document</title>
    <link rel="stylesheet" href="/style.css">


</head>
<body class="bg-main text-main">
    <h1>Sass Palette Generator</h1>
    <p>
        Lorem ipsum dolor sit amet consectetur adipisicing elit. 
        Aliquid nam repellendus, 
        dicta quasi, odit adipisci laborum, 
        nostrum reiciendis officiis ipsam aut inventore. 
        Quaerat esse fuga cupiditate est commodi laborum quas.
    </p>
    <button id="palette-theme-switch">
        Theme Switch
    </button>
    <script>

        window.addEventListener('load', function(){

            let themeElement = document.querySelector('html')
            let themeSwitch = document.querySelector('#palette-theme-switch');
            let prefersDarkTheme = window.matchMedia('(prefers-color-scheme: dark)');

            // Choose theme method stores the value in the browser and updates the html tag
            let themes = window.getComputedStyle(themeElement).getPropertyValue('--toggle-themes').trim().split(/\s*,\s*/)

            function toggleTheme() {
                let current = window.getComputedStyle(themeElement).getPropertyValue('--current-theme').trim()
                console.log(current)
                console.log(themes)

                let index = themes.indexOf(current)
                
                if (index >= themes.length - 1) {
                    index = 0
                } else {
                    index += 1
                }

                console.log(index)
                console.log(themes[index])
                themeElement.setAttribute('theme', themes[index])
            };

            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(v){
                toggleTheme()
            });

            themeSwitch.addEventListener('click', function(){
                toggleTheme()
            },false)

        }, false);
    </script>
</body>
</html>